CATEGORIES = ['date', 'num', 'day', 'visitor', 'visitor-lg', 'vgamenum', 'home', 'home-lg', 'hgamenum', 'vscore', 'hscore', 'gameouts', 'dn', 'sus', 'forfeit', 'protest', 'park', 'attend', 'time', 'vline', 'hline',
              'vab', 'vhit', 'vdb', 'vtr', 'vhr', 'vrbi', 'vsach', 'vsacf', 'vhbp', 'vw', 'viw', 'vso', 'vsb', 'vcs', 'vgdp', 'vci', 'vlob', 'vpuse', 'vier', 'vter', 'vwp', 'vbalk', 'vpo', 'va', 've', 'vpb', 'vdp', 'vtp',
              'hab', 'hhit', 'hdb', 'htr', 'hhr', 'hrbi', 'hsach', 'hsacf', 'hhbp', 'hw', 'hiw', 'hso', 'hsb', 'hcs', 'hgdp', 'hci', 'hlob', 'hpuse', 'hier', 'hter', 'hwp', 'hbalk', 'hpo', 'ha', 'he', 'hpb', 'hdp', 'htp',
              'umpid', 'umpname', '1bid', '1bname', '2bid', '2bname', '3bid', '3bname', 'lfid', 'lfname', 'rfid', 'rfname'
              'vmanid', 'vmanname', 'hmanid', 'hmanname', 'wpid', 'wpname', 'lpid', 'lpname', 'svpid', 'svpname', 'gwrbiid', 'gwrbiname', 'vspname', 'vspid', 'hspname', 'hspid',
              'v1id', 'v1name', 'v1pos', 'v2id', 'v2name', 'v2pos', 'v3id', 'v3name', 'v3pos', 'v4id', 'v4name', 'v4pos', 'v5id', 'v5name', 'v5pos', 'v6id', 'v6name', 'v6pos', 'v7id', 'v7name', 'v7pos', 'v8id', 'v8name', 'v8pos', 'v9id', 'v9name', 'v9pos',
              'h1id', 'h1name', 'h1pos', 'h2id', 'h2name', 'h2pos', 'h3id', 'h3name', 'h3pos', 'h4id', 'h4name', 'h4pos', 'h5id', 'h5name', 'h5pos', 'h6id', 'h6name', 'h6pos', 'h7id', 'h7name', 'h7pos', 'h8id', 'h8name', 'h8pos', 'h9id', 'h9name', 'h9pos',
              'addlin', 'acqin', 'dummy']
GL_FILES = ['gl/gl2023.txt', 'gl/gl2022.txt', 'gl/gl2021.txt', 'gl/gl2020.txt', 'gl/gl2019.txt']
PBP_FILES = {'2023': ['pbp/2023/2023ANA.EVA', 'pbp/2023/2023ARI.EVN', 'pbp/2023/2023ATL.EVN', 'pbp/2023/2023BAL.EVA', 'pbp/2023/2023BOS.EVA', 'pbp/2023/2023CHA.EVA', 'pbp/2023/2023CHN.EVN', 'pbp/2023/2023CIN.EVN', 'pbp/2023/2023CLE.EVA', 'pbp/2023/2023COL.EVN', 'pbp/2023/2023DET.EVA', 'pbp/2023/2023HOU.EVA', 'pbp/2023/2023KCA.EVA', 'pbp/2023/2023LAN.EVN', 'pbp/2023/2023MIA.EVN', 'pbp/2023/2023MIL.EVN', 'pbp/2023/2023MIN.EVA', 'pbp/2023/2023NYA.EVA', 'pbp/2023/2023NYN.EVN', 'pbp/2023/2023OAK.EVA', 'pbp/2023/2023PHI.EVN', 'pbp/2023/2023PIT.EVN', 'pbp/2023/2023SDN.EVN', 'pbp/2023/2023SEA.EVA', 'pbp/2023/2023SFN.EVN', 'pbp/2023/2023SLN.EVN', 'pbp/2023/2023TBA.EVA', 'pbp/2023/2023TEX.EVA', 'pbp/2023/2023TOR.EVA', 'pbp/2023/2023WAS.EVN'], 
             '2022': ['pbp/2022/2022ANA.EVA', 'pbp/2022/2022ARI.EVN', 'pbp/2022/2022ATL.EVN', 'pbp/2022/2022BAL.EVA', 'pbp/2022/2022BOS.EVA', 'pbp/2022/2022CHA.EVA', 'pbp/2022/2022CHN.EVN', 'pbp/2022/2022CIN.EVN', 'pbp/2022/2022CLE.EVA', 'pbp/2022/2022COL.EVN', 'pbp/2022/2022DET.EVA', 'pbp/2022/2022HOU.EVA', 'pbp/2022/2022KCA.EVA', 'pbp/2022/2022LAN.EVN', 'pbp/2022/2022MIA.EVN', 'pbp/2022/2022MIL.EVN', 'pbp/2022/2022MIN.EVA', 'pbp/2022/2022NYA.EVA', 'pbp/2022/2022NYN.EVN', 'pbp/2022/2022OAK.EVA', 'pbp/2022/2022PHI.EVN', 'pbp/2022/2022PIT.EVN', 'pbp/2022/2022SDN.EVN', 'pbp/2022/2022SEA.EVA', 'pbp/2022/2022SFN.EVN', 'pbp/2022/2022SLN.EVN', 'pbp/2022/2022TBA.EVA', 'pbp/2022/2022TEX.EVA', 'pbp/2022/2022TOR.EVA', 'pbp/2022/2022WAS.EVN'],
             '2021': ['pbp/2021/2021ANA.EVA', 'pbp/2021/2021ARI.EVN', 'pbp/2021/2021ATL.EVN', 'pbp/2021/2021BAL.EVA', 'pbp/2021/2021BOS.EVA', 'pbp/2021/2021CHA.EVA', 'pbp/2021/2021CHN.EVN', 'pbp/2021/2021CIN.EVN', 'pbp/2021/2021CLE.EVA', 'pbp/2021/2021COL.EVN', 'pbp/2021/2021DET.EVA', 'pbp/2021/2021HOU.EVA', 'pbp/2021/2021KCA.EVA', 'pbp/2021/2021LAN.EVN', 'pbp/2021/2021MIA.EVN', 'pbp/2021/2021MIL.EVN', 'pbp/2021/2021MIN.EVA', 'pbp/2021/2021NYA.EVA', 'pbp/2021/2021NYN.EVN', 'pbp/2021/2021OAK.EVA', 'pbp/2021/2021PHI.EVN', 'pbp/2021/2021PIT.EVN', 'pbp/2021/2021SDN.EVN', 'pbp/2021/2021SEA.EVA', 'pbp/2021/2021SFN.EVN', 'pbp/2021/2021SLN.EVN', 'pbp/2021/2021TBA.EVA', 'pbp/2021/2021TEX.EVA', 'pbp/2021/2021TOR.EVA', 'pbp/2021/2021WAS.EVN'],
             '2020': ['pbp/2020/2020ANA.EVA', 'pbp/2020/2020ARI.EVN', 'pbp/2020/2020ATL.EVN', 'pbp/2020/2020BAL.EVA', 'pbp/2020/2020BOS.EVA', 'pbp/2020/2020CHA.EVA', 'pbp/2020/2020CHN.EVN', 'pbp/2020/2020CIN.EVN', 'pbp/2020/2020CLE.EVA', 'pbp/2020/2020COL.EVN', 'pbp/2020/2020DET.EVA', 'pbp/2020/2020HOU.EVA', 'pbp/2020/2020KCA.EVA', 'pbp/2020/2020LAN.EVN', 'pbp/2020/2020MIA.EVN', 'pbp/2020/2020MIL.EVN', 'pbp/2020/2020MIN.EVA', 'pbp/2020/2020NYA.EVA', 'pbp/2020/2020NYN.EVN', 'pbp/2020/2020OAK.EVA', 'pbp/2020/2020PHI.EVN', 'pbp/2020/2020PIT.EVN', 'pbp/2020/2020SDN.EVN', 'pbp/2020/2020SEA.EVA', 'pbp/2020/2020SFN.EVN', 'pbp/2020/2020SLN.EVN', 'pbp/2020/2020TBA.EVA', 'pbp/2020/2020TEX.EVA', 'pbp/2020/2020TOR.EVA', 'pbp/2020/2020WAS.EVN'
             ],
             '2019': ['pbp/2019/2019ANA.EVA', 'pbp/2019/2019ARI.EVN', 'pbp/2019/2019ATL.EVN', 'pbp/2019/2019BAL.EVA', 'pbp/2019/2019BOS.EVA', 'pbp/2019/2019CHA.EVA', 'pbp/2019/2019CHN.EVN', 'pbp/2019/2019CIN.EVN', 'pbp/2019/2019CLE.EVA', 'pbp/2019/2019COL.EVN', 'pbp/2019/2019DET.EVA', 'pbp/2019/2019HOU.EVA', 'pbp/2019/2019KCA.EVA', 'pbp/2019/2019LAN.EVN', 'pbp/2019/2019MIA.EVN', 'pbp/2019/2019MIL.EVN', 'pbp/2019/2019MIN.EVA', 'pbp/2019/2019NYA.EVA', 'pbp/2019/2019NYN.EVN', 'pbp/2019/2019OAK.EVA', 'pbp/2019/2019PHI.EVN', 'pbp/2019/2019PIT.EVN', 'pbp/2019/2019SDN.EVN', 'pbp/2019/2019SEA.EVA', 'pbp/2019/2019SFN.EVN', 'pbp/2019/2019SLN.EVN', 'pbp/2019/2019TBA.EVA', 'pbp/2019/2019TEX.EVA', 'pbp/2019/2019TOR.EVA', 'pbp/2019/2019WAS.EVN']}
ROS_FILES = {'2023': ['ros/2023/ANA2023.ROS', 'ros/2023/ARI2023.ROS', 'ros/2023/ATL2023.ROS', 'ros/2023/BAL2023.ROS', 'ros/2023/BOS2023.ROS', 'ros/2023/CHA2023.ROS', 'ros/2023/CHN2023.ROS', 'ros/2023/CIN2023.ROS', 'ros/2023/CLE2023.ROS', 'ros/2023/COL2023.ROS', 'ros/2023/DET2023.ROS', 'ros/2023/HOU2023.ROS', 'ros/2023/KCA2023.ROS', 'ros/2023/LAN2023.ROS', 'ros/2023/MIA2023.ROS', 'ros/2023/MIL2023.ROS', 'ros/2023/MIN2023.ROS', 'ros/2023/NYA2023.ROS', 'ros/2023/NYN2023.ROS', 'ros/2023/OAK2023.ROS', 'ros/2023/PHI2023.ROS', 'ros/2023/PIT2023.ROS', 'ros/2023/SDN2023.ROS', 'ros/2023/SEA2023.ROS', 'ros/2023/SFN2023.ROS', 'ros/2023/SLN2023.ROS', 'ros/2023/TBA2023.ROS', 'ros/2023/TEX2023.ROS', 'ros/2023/TOR2023.ROS', 'ros/2023/WAS2023.ROS'], 
             '2022': ['ros/2022/ANA2022.ROS', 'ros/2022/ARI2022.ROS', 'ros/2022/ATL2022.ROS', 'ros/2022/BAL2022.ROS', 'ros/2022/BOS2022.ROS', 'ros/2022/CHA2022.ROS', 'ros/2022/CHN2022.ROS', 'ros/2022/CIN2022.ROS', 'ros/2022/CLE2022.ROS', 'ros/2022/COL2022.ROS', 'ros/2022/DET2022.ROS', 'ros/2022/HOU2022.ROS', 'ros/2022/KCA2022.ROS', 'ros/2022/LAN2022.ROS', 'ros/2022/MIA2022.ROS', 'ros/2022/MIL2022.ROS', 'ros/2022/MIN2022.ROS', 'ros/2022/NYA2022.ROS', 'ros/2022/NYN2022.ROS', 'ros/2022/OAK2022.ROS', 'ros/2022/PHI2022.ROS', 'ros/2022/PIT2022.ROS', 'ros/2022/SDN2022.ROS', 'ros/2022/SEA2022.ROS', 'ros/2022/SFN2022.ROS', 'ros/2022/SLN2022.ROS', 'ros/2022/TBA2022.ROS', 'ros/2022/TEX2022.ROS', 'ros/2022/TOR2022.ROS', 'ros/2022/WAS2022.ROS'],
             '2021': ['ros/2021/ANA2021.ROS', 'ros/2021/ARI2021.ROS', 'ros/2021/ATL2021.ROS', 'ros/2021/BAL2021.ROS', 'ros/2021/BOS2021.ROS', 'ros/2021/CHA2021.ROS', 'ros/2021/CHN2021.ROS', 'ros/2021/CIN2021.ROS', 'ros/2021/CLE2021.ROS', 'ros/2021/COL2021.ROS', 'ros/2021/DET2021.ROS', 'ros/2021/HOU2021.ROS', 'ros/2021/KCA2021.ROS', 'ros/2021/LAN2021.ROS', 'ros/2021/MIA2021.ROS', 'ros/2021/MIL2021.ROS', 'ros/2021/MIN2021.ROS', 'ros/2021/NYA2021.ROS', 'ros/2021/NYN2021.ROS', 'ros/2021/OAK2021.ROS', 'ros/2021/PHI2021.ROS', 'ros/2021/PIT2021.ROS', 'ros/2021/SDN2021.ROS', 'ros/2021/SEA2021.ROS', 'ros/2021/SFN2021.ROS', 'ros/2021/SLN2021.ROS', 'ros/2021/TBA2021.ROS', 'ros/2021/TEX2021.ROS', 'ros/2021/TOR2021.ROS', 'ros/2021/WAS2021.ROS'],
             '2020': ['ros/2020/ANA2020.ROS', 'ros/2020/ARI2020.ROS', 'ros/2020/ATL2020.ROS', 'ros/2020/BAL2020.ROS', 'ros/2020/BOS2020.ROS', 'ros/2020/CHA2020.ROS', 'ros/2020/CHN2020.ROS', 'ros/2020/CIN2020.ROS', 'ros/2020/CLE2020.ROS', 'ros/2020/COL2020.ROS', 'ros/2020/DET2020.ROS', 'ros/2020/HOU2020.ROS', 'ros/2020/KCA2020.ROS', 'ros/2020/LAN2020.ROS', 'ros/2020/MIA2020.ROS', 'ros/2020/MIL2020.ROS', 'ros/2020/MIN2020.ROS', 'ros/2020/NYA2020.ROS', 'ros/2020/NYN2020.ROS', 'ros/2020/OAK2020.ROS', 'ros/2020/PHI2020.ROS', 'ros/2020/PIT2020.ROS', 'ros/2020/SDN2020.ROS', 'ros/2020/SEA2020.ROS', 'ros/2020/SFN2020.ROS', 'ros/2020/SLN2020.ROS', 'ros/2020/TBA2020.ROS', 'ros/2020/TEX2020.ROS', 'ros/2020/TOR2020.ROS', 'ros/2020/WAS2020.ROS'],
             '2019': ['ros/2019/ANA2019.ROS', 'ros/2019/ARI2019.ROS', 'ros/2019/ATL2019.ROS', 'ros/2019/BAL2019.ROS', 'ros/2019/BOS2019.ROS', 'ros/2019/CHA2019.ROS', 'ros/2019/CHN2019.ROS', 'ros/2019/CIN2019.ROS', 'ros/2019/CLE2019.ROS', 'ros/2019/COL2019.ROS', 'ros/2019/DET2019.ROS', 'ros/2019/HOU2019.ROS', 'ros/2019/KCA2019.ROS', 'ros/2019/LAN2019.ROS', 'ros/2019/MIA2019.ROS', 'ros/2019/MIL2019.ROS', 'ros/2019/MIN2019.ROS', 'ros/2019/NYA2019.ROS', 'ros/2019/NYN2019.ROS', 'ros/2019/OAK2019.ROS', 'ros/2019/PHI2019.ROS', 'ros/2019/PIT2019.ROS', 'ros/2019/SDN2019.ROS', 'ros/2019/SEA2019.ROS', 'ros/2019/SFN2019.ROS', 'ros/2019/SLN2019.ROS', 'ros/2019/TBA2019.ROS', 'ros/2019/TEX2019.ROS', 'ros/2019/TOR2019.ROS', 'ros/2019/WAS2019.ROS'
             ]}
START_2022, END_2022 = '20220101', '20221231'

# Global Dicts
PLAYERS = dict() # Useage: PLAYERS[playerid] --> returns player object
#PITCHERS = dict() # Useage: PITCHERS[playerid] --> returns pitcher object
GAMELOG = dict() # Useage: GAMELOG[year][gameid] --> returns gamelog object # Todo: do we change this to be just gamelog[gameid]?
GAMES = dict() # Useage: GAMES[gameid] --> returns game object

# Misc helper functions
def get_prior_date(date):
    date = int(date) - 1
    return str(date)

def above_threshold(game, threshold=7):
    if game.team_stats['Total Games'] > threshold:
        return True
    return False